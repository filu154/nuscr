<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ltype (nuscr.Nuscrlib.Ltype)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">nuscr</a> &#x00BB; <a href="../index.html">Nuscrlib</a> &#x00BB; Ltype</nav><header class="odoc-preamble"><h1>Module <code><span>Nuscrlib.Ltype</span></code></h1><p>Local type management</p></header><div class="odoc-content"><p>This module defines local types and basic operations on them.</p><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span></code><table><tr id="type-t.RecvL" class="anchored"><td class="def variant constructor"><a href="#type-t.RecvL" class="anchor"></a><code><span>| </span><span><span class="constructor">RecvL</span> <span class="keyword">of</span> <a href="../Gtype/index.html#type-message">Gtype.message</a> * <a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> * <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>RecvL (msg, name, t)</code> waits for message <code>msg</code> from <code>name</code> and continues as <code>t</code></p><span class="comment-delim">*)</span></td></tr><tr id="type-t.SendL" class="anchored"><td class="def variant constructor"><a href="#type-t.SendL" class="anchor"></a><code><span>| </span><span><span class="constructor">SendL</span> <span class="keyword">of</span> <a href="../Gtype/index.html#type-message">Gtype.message</a> * <a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> * <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>SendL (msg, name, t)</code> sends message <code>msg</code> to <code>name</code> and continues as <code>t</code></p><span class="comment-delim">*)</span></td></tr><tr id="type-t.ChoiceL" class="anchored"><td class="def variant constructor"><a href="#type-t.ChoiceL" class="anchor"></a><code><span>| </span><span><span class="constructor">ChoiceL</span> <span class="keyword">of</span> <a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> * <span><a href="#type-t">t</a> <span class="xref-unresolved">Base</span>.list</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>ChoiceL (name, ts)</code> is a choice (internal or external) from <code>name</code> between the <code>ts</code></p><span class="comment-delim">*)</span></td></tr><tr id="type-t.TVarL" class="anchored"><td class="def variant constructor"><a href="#type-t.TVarL" class="anchor"></a><code><span>| </span><span><span class="constructor">TVarL</span> <span class="keyword">of</span> <a href="../Names/TypeVariableName/index.html#type-t">Names.TypeVariableName.t</a> * <span><a href="../Expr/index.html#type-t">Expr.t</a> <span class="xref-unresolved">Base</span>.list</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>TVarL (type_var, exprs)</code> is a type variable, scoped inside a recursion. <code>type_var</code> is the name of the type variable, <code>exprs</code> are expressions supplied into paramterised recursion, used in RefinementTypes extension. Otherwise an empty list is supplied when that feature is not used.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.MuL" class="anchored"><td class="def variant constructor"><a href="#type-t.MuL" class="anchor"></a><code><span>| </span><span><span class="constructor">MuL</span> <span class="keyword">of</span> <a href="../Names/TypeVariableName/index.html#type-t">Names.TypeVariableName.t</a> * <span><span>(<span class="xref-unresolved">Base</span>.bool * <a href="../Gtype/index.html#type-rec_var">Gtype.rec_var</a>)</span> <span class="xref-unresolved">Base</span>.list</span> * <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>MuL (type_var, rec_vars, l)</code> is a recursive type, corresponding to the syntax `\mu t. L`, where t is represented by <code>type_var</code> and L is represented by <code>t</code>. <code>rec_vars</code> are recursion parameters, where the first component represents whether the variable is a silent variable (with multiplicity 0). These parameters are used in RefinementTypes extension for parameterised recursion, an empty list is supplied when that feature is not used.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.EndL" class="anchored"><td class="def variant constructor"><a href="#type-t.EndL" class="anchor"></a><code><span>| </span><span><span class="constructor">EndL</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Empty type</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.InviteCreateL" class="anchored"><td class="def variant constructor"><a href="#type-t.InviteCreateL" class="anchor"></a><code><span>| </span><span><span class="constructor">InviteCreateL</span> <span class="keyword">of</span> <span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="xref-unresolved">Base</span>.list</span>
  * <span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="xref-unresolved">Base</span>.list</span>
  * <a href="../Names/ProtocolName/index.html#type-t">Names.ProtocolName.t</a>
  * <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Send invitations to existing roles and set up/create dynamic pariticipants, used only in NestedProtocols extension</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.AcceptL" class="anchored"><td class="def variant constructor"><a href="#type-t.AcceptL" class="anchor"></a><code><span>| </span><span><span class="constructor">AcceptL</span> <span class="keyword">of</span> <a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a>
  * <a href="../Names/ProtocolName/index.html#type-t">Names.ProtocolName.t</a>
  * <span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="xref-unresolved">Base</span>.list</span>
  * <span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="xref-unresolved">Base</span>.list</span>
  * <a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a>
  * <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>accept role@Proto(roles...; new roles...) from X; t, used only in Nested Protocols extension</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.SilentL" class="anchored"><td class="def variant constructor"><a href="#type-t.SilentL" class="anchor"></a><code><span>| </span><span><span class="constructor">SilentL</span> <span class="keyword">of</span> <a href="../Names/VariableName/index.html#type-t">Names.VariableName.t</a> * <a href="../Expr/index.html#type-payload_type">Expr.payload_type</a> * <a href="#type-t">t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Used with refinement types to indicate knowledge obtained via a global protocol, used only in RefinementTypes extension</p><span class="comment-delim">*)</span></td></tr></table></div><div class="spec-doc"><p>Local types. See also <a href="../LiteratureSyntax/index.html#type-local"><code>LiteratureSyntax.local</code></a> for a simpler syntax.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-LocalProtocolId" class="anchored"><a href="#module-LocalProtocolId" class="anchor"></a><code><span><span class="keyword">module</span> <a href="LocalProtocolId/index.html">LocalProtocolId</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Unique id identifying a local protocol</p></div></div><div class="odoc-spec"><div class="spec type" id="type-nested_t" class="anchored"><a href="#type-nested_t" class="anchor"></a><code><span><span class="keyword">type</span> nested_t</span><span> = <span><span>(<span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="xref-unresolved">Base</span>.list</span> * <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Base</span>.Map.M(<span class="xref-unresolved">LocalProtocolId</span>).t</span></span></code></div><div class="spec-doc"><p>Mapping of local protocol id to the protocol's roles and local type</p></div></div><div class="odoc-spec"><div class="spec value" id="val-show" class="anchored"><a href="#val-show" class="anchor"></a><code><span><span class="keyword">val</span> show : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.string</span></code></div><div class="spec-doc"><p>Converts a local type to a string.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-show_nested_t" class="anchored"><a href="#val-show_nested_t" class="anchor"></a><code><span><span class="keyword">val</span> show_nested_t : <span><a href="#type-nested_t">nested_t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-project" class="anchored"><a href="#val-project" class="anchor"></a><code><span><span class="keyword">val</span> project : <span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Gtype/index.html#type-t">Gtype.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Project a global type into a particular role.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-project_nested_t" class="anchored"><a href="#val-project_nested_t" class="anchor"></a><code><span><span class="keyword">val</span> project_nested_t : <span><a href="../Gtype/index.html#type-nested_t">Gtype.nested_t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-nested_t">nested_t</a></span></code></div><div class="spec-doc"><p>Generate the local protocols for a given global_t</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ensure_unique_tvars" class="anchored"><a href="#val-ensure_unique_tvars" class="anchor"></a><code><span><span class="keyword">val</span> ensure_unique_tvars : <span><a href="#type-nested_t">nested_t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-nested_t">nested_t</a></span></code></div><div class="spec-doc"><p>Ensure that all the local variables in each local protocol are globally unique, renaming variables to resolve conflicts</p></div></div><div class="odoc-spec"><div class="spec type" id="type-local_proto_name_lookup" class="anchored"><a href="#type-local_proto_name_lookup" class="anchor"></a><code><span><span class="keyword">type</span> local_proto_name_lookup</span><span> =
  <span><a href="../Names/LocalProtocolName/index.html#type-t">Names.LocalProtocolName.t</a> <span class="xref-unresolved">Base</span>.Map.M(<span class="xref-unresolved">LocalProtocolId</span>).t</span></span></code></div><div class="spec-doc"><p>Mapping from local protocol ids to their unique local protocol names</p></div></div><div class="odoc-spec"><div class="spec value" id="val-build_local_proto_name_lookup" class="anchored"><a href="#val-build_local_proto_name_lookup" class="anchor"></a><code><span><span class="keyword">val</span> build_local_proto_name_lookup : <span><a href="#type-nested_t">nested_t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-local_proto_name_lookup">local_proto_name_lookup</a></span></code></div><div class="spec-doc"><p>Builds a map containing the unique string representations for the unique local protocol ids</p></div></div><div class="odoc-spec"><div class="spec value" id="val-show_lookup_table" class="anchored"><a href="#val-show_lookup_table" class="anchor"></a><code><span><span class="keyword">val</span> show_lookup_table : <span><a href="#type-local_proto_name_lookup">local_proto_name_lookup</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.string</span></code></div><div class="spec-doc"><p>Converts a local protocol name lookup table to a string</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lookup_local_protocol" class="anchored"><a href="#val-lookup_local_protocol" class="anchor"></a><code><span><span class="keyword">val</span> lookup_local_protocol : 
  <span><a href="#type-local_proto_name_lookup">local_proto_name_lookup</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Names/ProtocolName/index.html#type-t">Names.ProtocolName.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Names/RoleName/index.html#type-t">Names.RoleName.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Names/LocalProtocolName/index.html#type-t">Names.LocalProtocolName.t</a></span></code></div><div class="spec-doc"><p>Return the unique local protocol name for a (role, protocol) pair</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lookup_protocol_id" class="anchored"><a href="#val-lookup_protocol_id" class="anchor"></a><code><span><span class="keyword">val</span> lookup_protocol_id : 
  <span><a href="#type-local_proto_name_lookup">local_proto_name_lookup</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="LocalProtocolId/index.html#type-t">LocalProtocolId.t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Names/LocalProtocolName/index.html#type-t">Names.LocalProtocolName.t</a></span></code></div><div class="spec-doc"><p>Look up the unique name for a local protocol id</p></div></div></div></body></html>